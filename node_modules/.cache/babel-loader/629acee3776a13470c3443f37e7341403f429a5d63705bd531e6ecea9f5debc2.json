{"ast":null,"code":"const OPENAI_API_URL='https://api.openai.com/v1/chat/completions';const SYSTEM_PROMPT=\"You are a helpful writing assistant. Review the text and return a list of editing suggestions in the following format: JSON with an array of objects, each containing:\\n- 'level' (1, 2, or 3),\\n- 'start' and 'end' character indices in the original string,\\n- 'original' (substring),\\n- 'replacement' (optional),\\n- 'reason' (brief explanation).\\nUse level 1 for grammar, 2 for cohesion/structure, 3 for content suggestions. Return only the JSON.\";export const analyzeText=async(text,apiKey)=>{if(!apiKey){throw new Error('OpenAI API key is required');}try{var _data$choices$,_data$choices$$messag;const response=await fetch(OPENAI_API_URL,{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(apiKey)},body:JSON.stringify({model:'gpt-4o',messages:[{role:'system',content:SYSTEM_PROMPT},{role:'user',content:text}],temperature:0.3,response_format:{type:'json_object'},max_tokens:2000})});if(!response.ok){var _errorData$error;const errorData=await response.json();throw new Error(\"OpenAI API error: \".concat(((_errorData$error=errorData.error)===null||_errorData$error===void 0?void 0:_errorData$error.message)||'Unknown error'));}const data=await response.json();const content=(_data$choices$=data.choices[0])===null||_data$choices$===void 0?void 0:(_data$choices$$messag=_data$choices$.message)===null||_data$choices$$messag===void 0?void 0:_data$choices$$messag.content;if(!content){throw new Error('No response content from OpenAI');}// Content can be already an object when using JSON mode\nif(typeof content==='object'){return content;}// Fallback: try to parse string content\ntry{const parsed=JSON.parse(content);return parsed;}catch(parseError){console.error('Failed to parse OpenAI response:',content);throw new Error('Invalid JSON response from OpenAI');}}catch(error){console.error('Error calling OpenAI API:',error);throw error;}};","map":{"version":3,"names":["OPENAI_API_URL","SYSTEM_PROMPT","analyzeText","text","apiKey","Error","_data$choices$","_data$choices$$messag","response","fetch","method","headers","concat","body","JSON","stringify","model","messages","role","content","temperature","response_format","type","max_tokens","ok","_errorData$error","errorData","json","error","message","data","choices","parsed","parse","parseError","console"],"sources":["/Users/thiagodonato/Documents/App_Projects/Edit_Text/src/api.ts"],"sourcesContent":["import { OpenAIResponse } from './types';\n\nconst OPENAI_API_URL = 'https://api.openai.com/v1/chat/completions';\n\nconst SYSTEM_PROMPT = `You are a helpful writing assistant. Review the text and return a list of editing suggestions in the following format: JSON with an array of objects, each containing:\n- 'level' (1, 2, or 3),\n- 'start' and 'end' character indices in the original string,\n- 'original' (substring),\n- 'replacement' (optional),\n- 'reason' (brief explanation).\nUse level 1 for grammar, 2 for cohesion/structure, 3 for content suggestions. Return only the JSON.`;\n\nexport const analyzeText = async (text: string, apiKey: string): Promise<OpenAIResponse> => {\n  if (!apiKey) {\n    throw new Error('OpenAI API key is required');\n  }\n\n  try {\n    const response = await fetch(OPENAI_API_URL, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${apiKey}`,\n      },\n      body: JSON.stringify({\n        model: 'gpt-4o',\n        messages: [\n          {\n            role: 'system',\n            content: SYSTEM_PROMPT,\n          },\n          {\n            role: 'user',\n            content: text,\n          },\n        ],\n        temperature: 0.3,\n        response_format: { type: 'json_object' },\n        max_tokens: 2000,\n      }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(`OpenAI API error: ${errorData.error?.message || 'Unknown error'}`);\n    }\n\n    const data = await response.json();\n    const content = data.choices[0]?.message?.content;\n\n    if (!content) {\n      throw new Error('No response content from OpenAI');\n    }\n\n    // Content can be already an object when using JSON mode\n    if (typeof content === 'object') {\n      return content as OpenAIResponse;\n    }\n\n    // Fallback: try to parse string content\n    try {\n      const parsed = JSON.parse(content);\n      return parsed;\n    } catch (parseError) {\n      console.error('Failed to parse OpenAI response:', content);\n      throw new Error('Invalid JSON response from OpenAI');\n    }\n  } catch (error) {\n    console.error('Error calling OpenAI API:', error);\n    throw error;\n  }\n}; "],"mappings":"AAEA,KAAM,CAAAA,cAAc,CAAG,4CAA4C,CAEnE,KAAM,CAAAC,aAAa,+bAMiF,CAEpG,MAAO,MAAM,CAAAC,WAAW,CAAG,KAAAA,CAAOC,IAAY,CAAEC,MAAc,GAA8B,CAC1F,GAAI,CAACA,MAAM,CAAE,CACX,KAAM,IAAI,CAAAC,KAAK,CAAC,4BAA4B,CAAC,CAC/C,CAEA,GAAI,KAAAC,cAAA,CAAAC,qBAAA,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAACT,cAAc,CAAE,CAC3CU,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,eAAe,WAAAC,MAAA,CAAYR,MAAM,CACnC,CAAC,CACDS,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,KAAK,CAAE,QAAQ,CACfC,QAAQ,CAAE,CACR,CACEC,IAAI,CAAE,QAAQ,CACdC,OAAO,CAAElB,aACX,CAAC,CACD,CACEiB,IAAI,CAAE,MAAM,CACZC,OAAO,CAAEhB,IACX,CAAC,CACF,CACDiB,WAAW,CAAE,GAAG,CAChBC,eAAe,CAAE,CAAEC,IAAI,CAAE,aAAc,CAAC,CACxCC,UAAU,CAAE,IACd,CAAC,CACH,CAAC,CAAC,CAEF,GAAI,CAACf,QAAQ,CAACgB,EAAE,CAAE,KAAAC,gBAAA,CAChB,KAAM,CAAAC,SAAS,CAAG,KAAM,CAAAlB,QAAQ,CAACmB,IAAI,CAAC,CAAC,CACvC,KAAM,IAAI,CAAAtB,KAAK,sBAAAO,MAAA,CAAsB,EAAAa,gBAAA,CAAAC,SAAS,CAACE,KAAK,UAAAH,gBAAA,iBAAfA,gBAAA,CAAiBI,OAAO,GAAI,eAAe,CAAE,CAAC,CACrF,CAEA,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAtB,QAAQ,CAACmB,IAAI,CAAC,CAAC,CAClC,KAAM,CAAAR,OAAO,EAAAb,cAAA,CAAGwB,IAAI,CAACC,OAAO,CAAC,CAAC,CAAC,UAAAzB,cAAA,kBAAAC,qBAAA,CAAfD,cAAA,CAAiBuB,OAAO,UAAAtB,qBAAA,iBAAxBA,qBAAA,CAA0BY,OAAO,CAEjD,GAAI,CAACA,OAAO,CAAE,CACZ,KAAM,IAAI,CAAAd,KAAK,CAAC,iCAAiC,CAAC,CACpD,CAEA;AACA,GAAI,MAAO,CAAAc,OAAO,GAAK,QAAQ,CAAE,CAC/B,MAAO,CAAAA,OAAO,CAChB,CAEA;AACA,GAAI,CACF,KAAM,CAAAa,MAAM,CAAGlB,IAAI,CAACmB,KAAK,CAACd,OAAO,CAAC,CAClC,MAAO,CAAAa,MAAM,CACf,CAAE,MAAOE,UAAU,CAAE,CACnBC,OAAO,CAACP,KAAK,CAAC,kCAAkC,CAAET,OAAO,CAAC,CAC1D,KAAM,IAAI,CAAAd,KAAK,CAAC,mCAAmC,CAAC,CACtD,CACF,CAAE,MAAOuB,KAAK,CAAE,CACdO,OAAO,CAACP,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACjD,KAAM,CAAAA,KAAK,CACb,CACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}